<!DOCTYPE html>
<html lang="en" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù„ÛŒØ³Øª Ù„ØºØª Ù‡Ø§</title>
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="./assets/css/bootstrap.min.css" />
  <link rel="stylesheet" href="./assets/css/Vazir-Code.css" />
  <link rel="stylesheet" href="./assets/css/style.css" />
</head>
<body style="text-align: center;">
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
      <a class="navbar-brand" href="./index.html">
        <h5 class="mb-0">ğŸ“š Ù¾Ø±ÙˆÚ˜Ù‡ Ù…ØªÙ† Ø¨Ø§Ø² Ø±ÛŒØªÙ…ÛŒÚ©</h5>
      </a>
      <button
        id="navbar-toggler"
        class="navbar-toggler"
        type="button"
        onclick="toggleNavbar()"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="./index.html">ØªØ­Ù„ÛŒÙ„ Ø´Ø¹Ø±</a>
          </li>
          <li class="nav-item active">
            <a class="nav-link" href="./list-words.html">Ù„ÛŒØ³Øª Ú©Ù„Ù…Ø§Øª</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="./about.html">Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ø§</a>
          </li>
        </ul>
      </div>
      <span class="text-muted">Ú©Ù„ Ú©Ù„Ù…Ø§Øª: <span id="totalWords" class="badge badge-light">Û°</span></span>
    </div>
  </nav>
  
  <div class="container mt-4">
    <h3 class="text-center mb-3">ğŸ“– Ú©Ù„Ù…Ø§Øª Ùˆ Ù‡Ø¬Ø§ÛŒ Ø¢Ù†â€ŒÙ‡Ø§</h3>

    <div class="stats-card">
      <div class="required-color stats-icon">ğŸ“</div>
      <p class="stats-title">Ù†ÛŒØ§Ø² Ø¨Ù‡ Ù…Ø­Ø§Ø³Ø¨Ù‡</p>
      <h4 class="stats-number count-word-need">Û°</h4>
    </div>
    <div class="stats-card">
      <div class="accepted-color stats-icon">âœ…</div>
      <p class="stats-title">ØªØ§ÛŒÛŒØ¯ Ø´Ø¯Ù‡</p>
      <h4 class="stats-number count-word-accept">Û°</h4>
    </div>
    <div class="stats-card">
      <div class="not-accepted-color stats-icon">âš ï¸</div>
      <p class="stats-title">ØªØ§ÛŒÛŒØ¯ Ù†Ø´Ø¯Ù‡</p>
      <h4 class="stats-number count-word-not-accept">Û°</h4>
    </div>
    <div class="stats-card">
      <div class="auto-color stats-icon">ğŸ¤–</div>
      <p class="stats-title">Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø±</p>
      <h4 class="stats-number count-word-dont-need">Û°</h4>
    </div>
    
    <div class="row mb-3">
      <div class="col-md-6">
        <div class="form-group">
          <label for="filterInput" class="form-label">ğŸ” Ø¬Ø³ØªØ¬ÙˆÛŒ Ú©Ù„Ù…Ù‡:</label>
          <input type="text" id="filterInput" placeholder="Ù…Ø«Ø§Ù„: Ø¨Ø§Ø±Ø§Ù†ØŒ Ø¯Ù„" class="form-control" />
        </div>
      </div>
      <div class="col-md-6">
        <div class="form-group">
          <label for="weightFilterInput" class="form-label">âš™ï¸ ÙÛŒÙ„ØªØ± ÙˆØ²Ù†:</label>
          <div class="input-group">
            <select class="custom-select" id="weightUnitSelect">
              <!-- Options added dynamically -->
            </select>
            <input type="text" id="weightFilterInput" placeholder="ÙˆØ²Ù† (Ù…Ø«Ø§Ù„: 101)" class="form-control" />
          </div>
        </div>
      </div>
    </div>
    
    <div class="text-center mb-3">
      <button class="btn btn-primary collect-btn" onclick="showChoseWord()">
        ğŸ“‹ Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ú©Ù„Ù…Ø§Øª Ø§Ù†ØªØ®Ø§Ø¨â€ŒØ´Ø¯Ù‡
      </button>
    </div>
    
    <div class="card mb-3">
      <div class="card-header">
        <strong>Ú©Ù„Ù…Ø§Øª Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø² Ø¨Ø±Ø§ÛŒ ØªØ£ÛŒÛŒØ¯</strong>
        <span class="badge badge-secondary" id="requiredCount">Û°</span>
      </div>
      <div class="card-body p-0">
        <div class="table-responsive">
          <table class="table table-sm table-hover mb-0">
            <thead>
              <tr>
                <th width="40">#</th>
                <th>Ú©Ù„Ù…Ù‡</th>
                <th>Ù‡Ø¬Ø§Ù‡Ø§</th>
                <th width="100">ÙˆØ¶Ø¹ÛŒØª</th>
                <th width="70">Ø§Ù†ØªØ®Ø§Ø¨</th>
              </tr>
            </thead>
            <tbody id="wordListBody">
              <!-- Words will be displayed here -->
            </tbody>
          </table>
        </div>
      </div>
    </div>
    
    <div class="card">
      <div class="card-header">
        <strong>Ú©Ù„Ù…Ø§Øª Ø¨Ø§ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø±</strong>
        <span class="badge badge-secondary" id="autoCount">Û°</span>
      </div>
      <div class="card-body p-0">
        <div class="table-responsive">
          <table class="table table-sm table-hover mb-0">
            <thead>
              <tr>
                <th width="40">#</th>
                <th>Ú©Ù„Ù…Ù‡</th>
                <th>Ù‡Ø¬Ø§Ù‡Ø§</th>
                <th width="100">ÙˆØ¶Ø¹ÛŒØª</th>
                <th width="70">Ø§Ù†ØªØ®Ø§Ø¨</th>
              </tr>
            </thead>
            <tbody id="wordListBody2">
              <!-- Words will be displayed here -->
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  
  <script src="./assets/js/word-list-dont-need.js"></script>
  <script src="./assets/js/check-poem.js"></script>
  <script src="./assets/js/custome.js"></script>
  <script>
    // Check if required variables exist
    if (typeof wordList === 'undefined') {
      console.error('wordList is not defined. Make sure check-poem.js is loaded.');
      wordList = {};
    }
    
    if (typeof acceptWordList === 'undefined') {
      console.warn('acceptWordList is not defined.');
      acceptWordList = {};
    }
    
    if (typeof baseWord === 'undefined') {
      console.error('baseWord is not defined. Make sure custome.js is loaded.');
      baseWord = {};
    }
    
    if (typeof baseWordShape === 'undefined') {
      console.error('baseWordShape is not defined. Make sure custome.js is loaded.');
      baseWordShape = {};
    }
    
    if (typeof getShapeOfWord === 'undefined') {
      console.error('getShapeOfWord function is not defined.');
      getShapeOfWord = function(wordObj) {
        // Default implementation if function doesn't exist
        return '';
      };
    }

    function printWords() {
      const inputText = document.querySelector('#filterInput');
      const weightInput = document.querySelector('#weightFilterInput');
      const filterValue = inputText.value.toLowerCase();
      const weightFilterValue = weightInput.value.toUpperCase();
      
      // Check if wordList exists
      if (!wordList || Object.keys(wordList).length === 0) {
        document.querySelector('#wordListBody').innerHTML = 
          '<tr><td colspan="5" class="text-center">Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯</td></tr>';
        return;
      }
      
      const htmlList = Object.keys(wordList)
        .filter((item) => {
          const matchesWord = item.includes(filterValue);
          let matchesWeight = true;
          
          if (weightInput.value !== '' && wordList[item]) {
            const shape = getShapeOfWord(wordList[item]);
            matchesWeight = shape == weightFilterValue;
          }
          
          return matchesWord && matchesWeight;
        })
        .map((item, key) => {
          // Get status
          let statusIcon = 'âš ï¸'; // Default: not accepted
          if (acceptWordList && acceptWordList[item] != null) {
            statusIcon = 'âœ…'; // Accepted
          }
          
          // Get syllables
          let syllables = '';
          if (wordList[item] && wordList[item].s) {
            syllables = wordList[item].s.join(' + ');
          }
          
          return `<tr>
            <td>${key + 1}</td>
            <td>${item}</td>
            <td>${syllables}</td>
            <td>${statusIcon}</td>
            <td><input name="word" value="${item}" type="checkbox" /></td>
          </tr>`;
        }).join('');
      
      document.querySelector('#wordListBody').innerHTML = htmlList;
      document.querySelector('#requiredCount').textContent = Object.keys(wordList).length;
    }

    function printWords2() {
      const inputText = document.querySelector('#filterInput');
      const weightInput = document.querySelector('#weightFilterInput');
      const filterValue = inputText.value.toLowerCase();
      const weightFilterValue = weightInput.value.toUpperCase();
      
      // Check if wordListDontNeed exists
      if (!wordListDontNeed || Object.keys(wordListDontNeed).length === 0) {
        document.querySelector('#wordListBody2').innerHTML = 
          '<tr><td colspan="5" class="text-center">Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯</td></tr>';
        return;
      }
      
      const htmlList = Object.keys(wordListDontNeed)
        .filter((item) => {
          const matchesWord = item.includes(filterValue);
          let matchesWeight = true;
          
          if (weightInput.value !== '' && wordListDontNeed[item]) {
            const shape = getShapeOfWord(wordListDontNeed[item]);
            matchesWeight = shape == weightFilterValue;
          }
          
          return matchesWord && matchesWeight;
        })
        .map((item, key) => {
          // Get syllables - FIXED HERE
          let syllables = '';
          if (wordListDontNeed[item] && wordListDontNeed[item].s) {
            syllables = wordListDontNeed[item].s.join(' + ');
          }
          
          return `<tr>
            <td>${key + 1}</td>
            <td>${item}</td>
            <td>${syllables}</td>
            <td>ğŸ¤–</td>
            <td><input name="word" value="${item}" type="checkbox" /></td>
          </tr>`;
        }).join('');
      
      document.querySelector('#wordListBody2').innerHTML = htmlList;
      document.querySelector('#autoCount').textContent = Object.keys(wordListDontNeed).length;
    }

    function showChoseWord() {
      const inputList = document.querySelectorAll('[type="checkbox"]');
      const result = [...inputList].filter((input) => input.checked).map((item) => item.value).join('\n');
      
      if (navigator.clipboard && window.isSecureContext) {
        navigator.clipboard.writeText(result)
          .then(() => {
            alert('Ú©Ù„Ù…Ø§Øª Ø§Ù†ØªØ®Ø§Ø¨â€ŒØ´Ø¯Ù‡ Ø¯Ø± Ú©Ù„ÛŒÙ¾â€ŒØ¨ÙˆØ±Ø¯ Ú©Ù¾ÛŒ Ø´Ø¯Ù†Ø¯.\n' + result);
          })
          .catch(err => {
            console.error('Failed to copy: ', err);
            alert('Ú©Ù„Ù…Ø§Øª Ø§Ù†ØªØ®Ø§Ø¨â€ŒØ´Ø¯Ù‡:\n' + result);
          });
      } else {
        alert('Ú©Ù„Ù…Ø§Øª Ø§Ù†ØªØ®Ø§Ø¨â€ŒØ´Ø¯Ù‡:\n' + result);
      }
    }

    function addBaseWordToSelect() {
      const selectElement = document.getElementById('weightUnitSelect');
      const weightInput = document.querySelector('#weightFilterInput');
      
      selectElement.innerHTML = '<option value="">Ø§Ù†ØªØ®Ø§Ø¨ ÙˆØ²Ù†...</option>';
      
      for (const key in baseWord) {
        const option = document.createElement('option');
        option.value = key;
        const shape = baseWordShape[key] || '';
        option.textContent = key + ' = ' + shape;
        
        if (weightInput.value.toUpperCase() == shape) {
          option.selected = true;
        }
        selectElement.appendChild(option);
      }
    }

    function choseWeight() {
      const selectElement = document.getElementById('weightUnitSelect');
      const weightInput = document.querySelector('#weightFilterInput');
      const chose = selectElement.value;
      weightInput.value = baseWordShape[chose] || '';
      printWords();
      printWords2();
    }

    // Event listeners
    document.getElementById('filterInput').addEventListener('input', function() {
      printWords();
      printWords2();
    });

    document.getElementById('weightFilterInput').addEventListener('input', function() {
      printWords();
      printWords2();
      addBaseWordToSelect();
    });

    document.getElementById('weightUnitSelect').addEventListener('change', choseWeight);

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      printWords();
      printWords2();
      addBaseWordToSelect();
      
      // Update total words count
      const totalWords = (Object.keys(wordList || {}).length + 
                         Object.keys(wordListDontNeed || {}).length);
      document.getElementById('totalWords').textContent = totalWords;
    });
  </script>
</body>
</html>